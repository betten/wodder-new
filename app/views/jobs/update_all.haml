- @gyms.each do |gym|
  .gym.notupdated{ :id => gym.id }
    %span.name= gym.name
    %span ...
    %strong.status

:javascript
  var updateNextGym = function() {
    if(!$('.notupdated').length) return false;
    var current_gym = $('.notupdated').first();
    var status = current_gym.find('.status');
    status.text('checking...');
    $.post('/jobs/update/' + current_gym.attr('id'), function(data) {
      current_gym.removeClass('notupdated');
      if(data.updated) {
        status.text('updated');
      } else if(data.latest) {
        status.text('latest');
      } else {
        status.css('color', '#f00').text('error');
      }
      updateNextGym();
    }, 'json');
  };
  $(document).ready(function() {
    updateNextGym();
  });
